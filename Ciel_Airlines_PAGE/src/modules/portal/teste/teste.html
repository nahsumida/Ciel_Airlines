<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ATWU - administrativo</title>
    <link rel="stylesheet" href="teste.css" />
    <script defer src="js/script.js"></script>
    <link rel="shortcut icon" href="imagens/favicon.ico" type="image/x-icon" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0"
    />
  </head>
  <body>
    <header>
      <div class="img"><img src="imagens/logo.branco.png" alt="" /></div>
      <nav>
        <ul>
          <li><a href="">Home</a></li>
          <li class="logout">
            <a href="">Log out</a>
            <span class="material-symbols-outlined">logout</span>
          </li>
        </ul>
      </nav>
    </header>
    <main>
      <section class="opc">
        <h1>Menu administrativo</h1>
        <h2>Bem Vindo(a)!</h2>
        <ul>
          <li>
            <span class="material-symbols-outlined">travel</span>
            <button id="btnAeronaves">Aeronaves</button>
          </li>
          <li>
            <span class="material-symbols-outlined"
              >airline_seat_recline_normal</span
            >
            <button id="btnMapa">Mapa de assentos</button>
          </li>
          <li>
            <span class="material-symbols-outlined">flight_takeoff</span>
            <button id="btnVoos">Voos</button>
          </li>
        </ul>
      </section>
      <section class="aeronaves">
        <h1>Aeronaves</h1>
        <form id="cadastroAeronave">
          <div class="form-group">
            <label for="modelo">Modelo:</label>
            <input type="text" id="modelo" name="modelo" required />
          </div>
          <div class="form-group">
            <label for="id">ID:</label>
            <input type="text" id="id" name="id" required />
          </div>
          <div class="form-group">
            <label for="fabricante">Fabricante:</label>
            <input type="text" id="fabricante" name="fabricante" required />
          </div>
          <div class="form-group">
            <label for="ano">Ano de Fabricação:</label>
            <input type="number" id="ano" name="ano" required />
          </div>
          <div class="form-group">
            <label for="mapas">Mapa Assento:</label>
            <input type="number" id="mapas" name="mapas" required />
          </div>
          <div class="btns">
            <input
              type="button"
              onclick="inserirAeronave()"
              class="btn-form"
              value="Cadastrar"
            />

            <input
              onclick="alterarAeronave()"
              class="btn-form"
              type="submit"
              value="Alterar"
            />
            <input
              onclick="excluirAeronave()"
              class="btn-form"
              type="submit"
              value="Excluir"
            />
          </div>
        </form>
        <div class="table-container">
          <table class="table-aeronaves">
            <thead>
              <th>Modelo</th>
              <th>Id</th>
              <th>Fabricante</th>
              <th>Ano de Fabricação</th>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </section>
      <section class="mapa">
        <h1>Mapa de Assentos</h1>
        <div class="container-aviao22">
          <div class="frente"></div>
          <div class="aviao22">
            <div class="fileira-num">
              <div class="num">1</div>
              <div class="num">2</div>
              <div class="num">3</div>
              <div class="num">4</div>
              <div class="num">5</div>
              <div class="num">6</div>
              <div class="num">7</div>
              <div class="num">8</div>
              <div class="num">9</div>
              <div class="num">10</div>
              <div class="num">11</div>
              <div class="num">12</div>
            </div>
            <div class="fileiraA">
              <div class="assento">A</div>
              <div class="assento">A</div>
              <div class="assento">A</div>
              <div class="assento">A</div>
              <div class="assento">A</div>
              <div class="assento">A</div>
              <div class="assento">A</div>
              <div class="assento">A</div>
              <div class="assento">A</div>
              <div class="assento">A</div>
              <div class="assento">A</div>
              <div class="assento">A</div>
            </div>
            <div class="fileiraB">
              <div class="assento">B</div>
              <div class="assento">B</div>
              <div class="assento">B</div>
              <div class="assento">B</div>
              <div class="assento">B</div>
              <div class="assento">B</div>
              <div class="assento">B</div>
              <div class="assento">B</div>
              <div class="assento">B</div>
              <div class="assento">B</div>
              <div class="assento">B</div>
              <div class="assento">B</div>
            </div>
            <div class="fileiraC">
              <div class="assento">C</div>
              <div class="assento">C</div>
              <div class="assento">C</div>
              <div class="assento">C</div>
              <div class="assento">C</div>
              <div class="assento">C</div>
              <div class="assento">C</div>
              <div class="assento">C</div>
              <div class="assento">C</div>
              <div class="assento">C</div>
              <div class="assento">C</div>
              <div class="assento">C</div>
            </div>
            <div class="fileiraD">
              <div class="assento">D</div>
              <div class="assento">D</div>
              <div class="assento">D</div>
              <div class="assento">D</div>
              <div class="assento">D</div>
              <div class="assento">D</div>
              <div class="assento">D</div>
              <div class="assento">D</div>
              <div class="assento">D</div>
              <div class="assento">D</div>
              <div class="assento">D</div>
              <div class="assento">D</div>
            </div>
          </div>
        </div>
      </section>
      <section class="voos">
        <h1>Voos</h1>
        <form id="cadastroVoo">
          <div class="form-group">
            <label for="numeroVoo">Numero do Voo:</label>
            <input type="text" id="numeroVoo" name="numerovoo" required />
          </div>
          <div class="form-group">
            <label for="datavoo">Data:</label>
            <input type="date" id="dataVoo" name="datavoo" required />
          </div>
          <div class="form-group">
            <label for="trecho">Trecho:</label>
            <input type="text" id="trecho" name="trecho" required />
          </div>
          <div class="form-group">
            <label for="horaPartida">Horário Previsto de Partida:</label>
            <input type="time" id="horaPartida" name="horaPartida" required />
          </div>
          <div class="form-group">
            <label for="horaChegada">Horário Previsto de Chegada:</label>
            <input type="time" id="horaChegada" name="horaChegada" required />
          </div>
          <div class="form-group">
            <label for="aeroportoSaida">Aeroporto de Saída:</label>
            <input
              type="text"
              id="aeroportoSaida"
              name="aeroportoSaida"
              required
            />
          </div>
          <div class="form-group">
            <label for="aeroportoChegada">Aeroporto de Chegada:</label>
            <input
              type="text"
              id="aeroportoChegada"
              name="aeroportoChegada"
              required
            />
          </div>
          <div class="form-group">
            <label for="valorAssento">Valor do Assento:</label>
            <input
              type="number"
              id="valorAssento"
              name="valorAssento"
              required
            />
          </div>
          <div class="btns">
            <input
              type="button"
              onclick="inserirVoo()"
              class="btn-form"
              value="Cadastrar"
            />

            <input
              onclick="alterarVoo()"
              class="btn-form"
              type="submit"
              value="Alterar"
            />
            <input
              onclick="excluirVoo()"
              class="btn-form"
              type="submit"
              value="Excluir"
            />
          </div>
        </form>
        <div class="table-container">
          <table class="table-voos">
            <thead>
              <th>Numero do Voo</th>
              <th>Data</th>
              <th>Trecho</th>
              <th>Horario Partida</th>
              <th>Horario Chegada</th>
              <th>Saída</th>
              <th>Chegada</th>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </section>
    </main>
  </body>
  <script>
    function inserirAeronave() {
      const modelo = document.getElementById("modelo").value;
      const id = document.getElementById("id").value;
      const fabricante = document.getElementById("fabricante").value;
      const ano = parseInt(document.getElementById("ano").value);
      const mapas = parseInt(document.getElementById("mapas").value);

      const aeronaveData = {
        MODELO: modelo,
        N_IDENTIFICACAO: id,
        FABRICANTE: fabricante,
        ANO_FABRICACAO: ano,
        MAPAASSENTOS: mapas,
      };

      console.log(aeronaveData);

      fetch("http://localhost:3000/incluirAeronave", {
        method: "PUT",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify(aeronaveData),
      })
        .then((response) => {
          console.log(response);

          if (response.status === 200) {
            return response.json();
            const successMessage = document.createElement("div");
            successMessage.textContent = "Aeronave cadastrada com sucesso!";
            successMessage.className = "statusSuccess";
            document.body.appendChild(successMessage);
          } else {
            throw new Error("Erro ao cadastrar aeronave.");
          }
        })
        .catch((error) => {
          console.log(error);
        })
        .finally(() => {
          obterAeronaves();
        });
    }

    function alterarAeronave() {
      const modelo = document.getElementById("modelo").value;
      const id = document.getElementById("id").value;
      const fabricante = document.getElementById("fabricante").value;
      const ano = parseInt(document.getElementById("ano").value);
      const mapas = parseInt(document.getElementById("mapas").value);

      const aeronaveData = {
        MODELO: modelo,
        N_IDENTIFICACAO: id,
        FABRICANTE: fabricante,
        ANO_FABRICACAO: ano,
        MAPAASSENTOS: mapas,
      };

      console.log(aeronaveData);

      fetch("http://localhost:3000/alterarAeronave", {
        method: "PUT",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify(aeronaveData),
      })
        .then((response) => {
          if (response.status === 200) {
            return response.json();
            const successMessage = document.createElement("div");
            successMessage.textContent = "Aeronave alterada com sucesso!";
            successMessage.className = "statusSuccess";
            document.body.appendChild(successMessage);
          } else {
            throw new Error("Erro ao alterar aeronave.");
          }
        })
        .catch((error) => {
          console.log(error);
        })
        .finally(() => {
          obterAeronaves();
        });
    }

    function excluirAeronave() {
      const id = document.getElementById("id").value;

      const aeronaveData = {
        N_IDENTIFICACAO: id,
      };

      console.log(aeronaveData);

      fetch("http://localhost:3000/excluirAeronave", {
        method: "DELETE",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify(aeronaveData),
      })
        .then((response) => {
          if (response.status === 200) {
            return response.json();
            const successMessage = document.createElement("div");
            successMessage.textContent = "Aeronave excluida com sucesso!";
            successMessage.className = "statusSuccess";
            document.body.appendChild(successMessage);
          } else {
            throw new Error("Erro ao excluir aeronave.");
          }
        })
        .catch((error) => {
          console.log(error);
        })
        .finally(() => {
          obterAeronaves();
        });
    }

    function inserirVoo() {
      const N_VOO = document.getElementById("numeroVoo").value;
      const DATA_VOO = document.getElementById("dataVoo").value;
      const ID_TRECHO = parseInt(document.getElementById("trecho").value);
      const H_PARTIDA = document.getElementById("horaPartida").value;
      const H_CHEGADA = document.getElementById("horaChegada").value;
      const AERO_ORIGEM = document.getElementById("aeroportoSaida").value;
      const AERO_DESTINO = document.getElementById("aeroportoChegada").value;
      const VALOR_ASS = parseInt(document.getElementById("valorAssento").value);

      const vooData = {
        N_VOO: N_VOO,
        DATA_VOO: DATA_VOO,
        ID_TRECHO: ID_TRECHO,
        H_PARTIDA: H_PARTIDA,
        H_CHEGADA: H_CHEGADA,
        AERO_ORIGEM: AERO_ORIGEM,
        AERO_DESTINO: AERO_DESTINO,
        VALOR_ASS: VALOR_ASS,
      };

      console.log(vooData);

      fetch("http://localhost:3000/incluirVoos", {
        method: "PUT",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify(vooData),
      })
        .then((response) => {
          if (response.status === 200) {
            return response.json();
            const successMessage = document.createElement("div");
            successMessage.textContent = "Voo cadastrado com sucesso!";
            successMessage.className = "statusSuccess";
            document.body.appendChild(successMessage);
          } else {
            throw new Error("Erro ao cadastrar voo.");
          }
        })
        .catch((error) => {
          console.log(error);
        })
        .finally(() => {
          obterVoos();
          containerVoos.style.display = "block";
        });
    }

    function alterarVoo() {
      const N_VOO = document.getElementById("numeroVoo").value;
      const DATA_VOO = document.getElementById("dataVoo").value;
      const ID_TRECHO = parseInt(document.getElementById("trecho").value);
      const H_PARTIDA = document.getElementById("horaPartida").value;
      const H_CHEGADA = document.getElementById("horaChegada").value;
      const AERO_ORIGEM = document.getElementById("aeroportoSaida").value;
      const AERO_DESTINO = document.getElementById("aeroportoChegada").value;
      const VALOR_ASS = parseInt(document.getElementById("valorAssento").value);

      const vooData = {
        N_VOO: N_VOO,
        DATA_VOO: DATA_VOO,
        ID_TRECHO: ID_TRECHO,
        H_PARTIDA: H_PARTIDA,
        H_CHEGADA: H_CHEGADA,
        AERO_ORIGEM: AERO_ORIGEM,
        AERO_DESTINO: AERO_DESTINO,
        VALOR_ASS: VALOR_ASS,
      };

      console.log(vooData);

      fetch("http://localhost:3000/alterarVoos", {
        method: "PUT",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify(vooData),
      })
        .then((response) => {
          if (response.status === 200) {
            return response.json();
            const successMessage = document.createElement("div");
            successMessage.textContent = "Voo alterado com sucesso!";
            successMessage.className = "statusSuccess";
            document.body.appendChild(successMessage);
          } else {
            throw new Error("Erro ao alterar voo.");
          }
        })
        .catch((error) => {
          console.log(error);
        })
        .finally(() => {
          obterVoos();
          containerVoos.style.display = "block";
        });
    }

    function excluirVoo() {
      const N_VOO = document.getElementById("numeroVoo").value;

      const vooData = {
        N_VOO: N_VOO,
      };

      fetch("http://localhost:3000/excluirVoos", {
        method: "DELETE",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify(vooData),
      })
        .then((response) => {
          if (response.status === 200) {
            return response.json();
            const successMessage = document.createElement("div");
            successMessage.textContent = "Voo excluido com sucesso!";
            successMessage.className = "statusSuccess";
            document.body.appendChild(successMessage);
          } else {
            throw new Error("Erro ao excluir voo.");
          }
        })
        .catch((error) => {
          console.log(error);
        })
        .finally(() => {
          obterVoos();
          containerVoos.style.display = "block";
        });
    }

    function obterAeronaves() {
      fetch("http://localhost:3000/obterAeronaves")
        .then((response) => {
          if (response.status === 200) {
            return response.json();
          } else {
            throw new Error("Erro ao obter aeronaves.");
          }
        })
        .then((data) => {
          console.log(data);
          const tableBody = document.querySelector(".table-aeronaves tbody");
          tableBody.innerHTML = ""; // Limpa o conteúdo anterior

          data.forEach((aeronave) => {
            const modelo = aeronave[0];
            const id = aeronave[1];
            const fabricante = aeronave[2];
            const anoFabricacao = aeronave[3];

            const row = document.createElement("tr");
            row.innerHTML = `<td>${modelo}</td><td>${id}</td><td>${fabricante}</td><td>${anoFabricacao}</td>`;
            tableBody.appendChild(row);
          });
        })
        .catch((error) => {
          console.log(error);
        })
        .finally(() => {
          obterVoos();
          containerVoos.style.display = "none";
        });
    }

    function obterVoos() {
      fetch("http://localhost:3000/obterVoos")
        .then((response) => {
          if (response.status === 200) {
            return response.json();
          } else {
            throw new Error("Erro ao obter voos.");
          }
        })
        .then((data) => {
          console.log(data);
          const tableBody = document.querySelector(".table-voos tbody");
          tableBody.innerHTML = "";

          data.forEach((voo) => {
            const numeroVoo = voo[0];
            const dataVoo = voo[1];
            const trecho = voo[2];
            const horaPartida = voo[4];
            const horaChegada = voo[5];
            const aeroOrigem = voo[6];
            const aeroDestino = voo[7];

            const row = document.createElement("tr");
            row.innerHTML = `<td>${numeroVoo}</td><td>${dataVoo}</td><td>${trecho}</td><td>${horaPartida}</td><td>${horaChegada}</td><td>${aeroOrigem}</td><td>${aeroDestino}</td>`;
            tableBody.appendChild(row);
          });
        })
        .catch((error) => {
          console.log(error);
        });
    }

    window.addEventListener("load", obterAeronaves);
    window.addEventListener("load", obterVoos);
  </script>
  <style>
    .statusError {
      color: red;
    }
    .statusSuccess {
      color: blue;
    }
  </style>
</html>